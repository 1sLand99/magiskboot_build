add_library(platform_stubs STATIC
    src/sendfile_compat.c)
target_include_directories(platform_stubs PUBLIC include)

if (WIN32)
add_library(libmman STATIC
    vendor/mman-win32/mman.c)
target_include_directories(libmman PUBLIC vendor/mman-win32)
target_link_libraries(platform_stubs INTERFACE libmman)

add_library(libgetline STATIC
        vendor/msvc_getline/getline.c)
target_include_directories(libgetline PUBLIC vendor/msvc_getline)
target_link_libraries(platform_stubs INTERFACE libgetline)
endif()

if (NOT ${CMAKE_SYSTEM_NAME} STREQUAL "Linux")
    target_link_libraries(libbase platform_stubs)
    target_link_libraries(magiskboot platform_stubs)
endif()
